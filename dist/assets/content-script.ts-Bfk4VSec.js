var d=Object.defineProperty;var a=(i,e,t)=>e in i?d(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var n=(i,e,t)=>a(i,typeof e!="symbol"?e+"":e,t);class c{constructor(){n(this,"events",[]);n(this,"isRecording",!1);n(this,"startTime",0);n(this,"handleMouseMove",e=>{if(!this.isRecording)return;const t=Date.now()-this.startTime;this.events.push({x:e.clientX,y:e.clientY,timestamp:t,type:"move"})});n(this,"handleClick",e=>{if(!this.isRecording)return;const t=Date.now()-this.startTime;this.events.push({x:e.clientX,y:e.clientY,timestamp:t,type:"click"})})}start(){this.isRecording=!0,this.events=[],this.startTime=Date.now(),window.addEventListener("mousemove",this.handleMouseMove,{capture:!0}),window.addEventListener("click",this.handleClick,{capture:!0}),console.log("Metadata recorder started")}async stop(){return this.isRecording=!1,window.removeEventListener("mousemove",this.handleMouseMove,{capture:!0}),window.removeEventListener("click",this.handleClick,{capture:!0}),console.log("Metadata recorder stopped",this.events),this.events}getEvents(){return this.events}}const r=new c;typeof chrome<"u"&&chrome.runtime&&chrome.runtime.onMessage&&chrome.runtime.onMessage.addListener((i,e,t)=>{if(i.type==="GET_DIMENSIONS")t({width:window.innerWidth,height:window.innerHeight,dpr:window.devicePixelRatio});else if(i.type==="START_RECORDING")r.start(),t({status:"started"});else if(i.type==="STOP_RECORDING")return r.stop().then(s=>{const o={width:window.innerWidth,height:window.innerHeight,dpr:window.devicePixelRatio};t({status:"stopped",data:{events:s,viewport:o}})}),!0});export{c as MetadataRecorder};
